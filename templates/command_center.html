{% extends "base.html" %}

{% block title %}Command Center - MyCobot320{% endblock %}

{% block content %}
<div class="status-panel">
    <div class="section-title">Robot Status</div>
    <div class="status-grid">
        <div class="status-item">
            <div><span id="connection-indicator" class="status-indicator"></span>Connection</div>
            <div id="connection-status">Checking...</div>
        </div>
        <div class="status-item">
            <div>Current Position</div>
            <div style="font-size: 10px; font-family: monospace;">
                J1: <span id="angle-0">0°</span>, J2: <span id="angle-1">0°</span>, J3: <span id="angle-2">0°</span><br>
                J4: <span id="angle-3">0°</span>, J5: <span id="angle-4">0°</span>, J6: <span id="angle-5">0°</span>
            </div>
        </div>
        <div class="status-item">
            <div>Video Recording</div>
            <div id="video-recording-status">Idle</div>
        </div>
    </div>
</div>

<div class="main-content">
    <div class="control-grid">
        <div class="control-section">
            <div class="section-title">Quick Controls</div>
            <button onclick="moveHome()">🏠 Home Position</button>
            <button onclick="extend()">📏 Extend</button>
            <button onclick="powerOff()" class="btn-warning">⚡ Power Off</button>
        </div>

        <div class="control-section">
            <div class="section-title">Saved Positions</div>
            <div id="command-buttons" class="command-buttons">
                <!-- Position buttons will be loaded by JavaScript -->
            </div>
        </div>
    </div>

    <div class="video-panel">
        <div class="section-title">📹 Camera Feed</div>
        <div class="video-container">
            <img id="video-stream" class="video-stream" src="/video_feed" alt="Camera Feed">
            <div id="video-placeholder" class="video-placeholder">
                Camera Off<br>
                <small>Click Start Camera to begin streaming</small>
            </div>
        </div>
        <button id="start-camera-btn" onclick="startCamera()" class="btn-primary">Start Camera</button>
        <button id="stop-camera-btn" onclick="stopCamera()" class="btn-danger" disabled>Stop Camera</button>
        <button id="screenshot-btn" onclick="takeScreenshot()" class="btn-warning" disabled>📸 Screenshot</button>
        <br><br>
        <button id="start-video-btn" onclick="startVideoRecording()" class="btn-primary" disabled>🎥 Start Recording</button>
        <button id="stop-video-btn" onclick="stopVideoRecording()" class="btn-danger" disabled>⏹️ Stop Recording</button>
        <div id="video-status" style="margin-top: 10px; font-size: 12px; color: rgba(255,255,255,0.8);"></div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/positions.js') }}"></script>
<script src="{{ url_for('static', filename='js/camera.js') }}"></script>
{% endblock %}